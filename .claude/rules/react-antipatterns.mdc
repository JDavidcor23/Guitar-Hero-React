---
alwaysApply: true
---

# Antipatrones y Errores Frecuentes en React

## 1. Props Drilling Excesivo

### ‚ùå MAL - Props Drilling
```jsx
<GrandParent user={user}>
  <Parent user={user}>
    <Child user={user}>
      <GrandChild user={user} />
    </Child>
  </Parent>
</GrandParent>
```

### ‚úÖ BIEN - Context Provider Local
```jsx
const UserContext = createContext();

<UserContext.Provider value={user}>
  <GrandParent>
    <Parent>
      <Child>
        <GrandChild />
      </Child>
    </Parent>
  </GrandParent>
</UserContext.Provider>

// En GrandChild:
const user = useContext(UserContext);
```

### üìè Regla de Niveles:
- **1-2 niveles de props** = ‚úÖ OK
- **3+ niveles de props** = ‚ùå Usar Context

## 2. Evitar GrandParentProvider

### ‚ùå MAL - Provider muy arriba en el √°rbol
```jsx
// App.jsx - Demasiado alto
<UserProvider>
  <Router>
    <Routes>
      <Route path="/users" element={<UsersFeature />} />
      <Route path="/products" element={<ProductsFeature />} />
    </Routes>
  </Router>
</UserProvider>
```

### ‚úÖ BIEN - Provider cerca de donde se usa
```jsx
// UsersFeature.jsx - Cerca del uso
<UserProvider>
  <UserTable />
  <UserForm />
</UserProvider>
```

## 3. Principio de Proximidad para Context

### Crear Providers:
- **Lo m√°s cerca posible** de donde se usan
- **Dentro de la feature** que los necesita
- **No en el nivel de aplicaci√≥n** a menos que sea realmente global

### Estructura Recomendada:
```
src/features/users/
‚îú‚îÄ‚îÄ UserProvider.jsx          # Provider espec√≠fico de la feature
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useUser.hook.js      # Hook para consumir el context
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ UserTable.jsx        # Consume el context
‚îÇ   ‚îî‚îÄ‚îÄ UserForm.jsx         # Consume el context
‚îî‚îÄ‚îÄ Users.jsx                # Envuelve con el Provider
```

## 4. Reglas de Context

### Cu√°ndo usar Context:
- **Props pasan por 3+ componentes**
- **M√∫ltiples componentes necesitan los mismos datos**
- **Estado compartido en una feature espec√≠fica**

### Cu√°ndo NO usar Context:
- **Solo 1-2 niveles de props**
- **Datos que cambian muy frecuentemente**
- **Estado que solo usa un componente**

## 5. Patr√≥n de Provider + Hook

### ‚úÖ Estructura Recomendada:
```jsx
// UserProvider.jsx
const UserContext = createContext();

export const UserProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  
  return (
    <UserContext.Provider value={{ user, setUser }}>
      {children}
    </UserContext.Provider>
  );
};

// useUser.hook.js
export const useUser = () => {
  const context = useContext(UserContext);
  if (!context) {
    throw new Error('useUser must be used within UserProvider');
  }
  return context;
};
```

## 6. Aplicaci√≥n Autom√°tica

Cuando detectes props drilling:
1. **Identifica el alcance** - ¬øQu√© componentes necesitan los datos?
2. **Crea el Provider** en el componente padre m√°s cercano
3. **Crea el hook personalizado** para consumir el context
4. **Reemplaza las props** con el hook en los componentes hijos
5. **Mant√©n el Provider local** a la feature que lo usa
